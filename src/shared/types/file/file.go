package types

import (
	"bytes"
	"compress/gzip"
	"errors"
)

type File struct {
	Name         string
	Size         int64
	Data         []byte
	IsCompressed bool
}

func (f *File) Compress() error {
	if len(f.Data) == 0 {
		return errors.New("no data to compress")
	}

	var buffer bytes.Buffer
	writer := gzip.NewWriter(&buffer)

	if _, err := writer.Write(f.Data); err != nil {
		return err
	}

	f.Data = buffer.Bytes()
	f.IsCompressed = true
	return nil
}

func (f File) New(filename string, data []byte) File {
	return File{
		Name: filename,
		Size: int64(len(data)),
		Data: data,
	}
}
