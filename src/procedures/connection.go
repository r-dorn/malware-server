package procedures

import (
	"crypto/rand"
	"time"
)

const DEFAULT_TTL time.Duration = time.Minute * 5 /*
	bot has 5 minutes to connect  or it will have to request a new one via GEN_NEW_CODE*/

type ConnectionKey struct {
	Ttl      time.Duration
	IssuedAt time.Time
	AuthCode string
}

func Generate(codeLen int, ttl time.Duration) (ConnectionKey, error) {
	generatedBytes := make([]byte, codeLen)
	if _, err := rand.Read(generatedBytes); err != nil {
		return ConnectionKey{}, err
	}
	return ConnectionKey{
		Ttl:      ttl,
		IssuedAt: time.Now(),
		AuthCode: string(generatedBytes),
	}, nil
}
